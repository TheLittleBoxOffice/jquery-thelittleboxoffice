/*! jquery-thelittleboxoffice 2014-09-09 */
!function(a,b,c,d){function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="lboComponents",g={client_id:0,view_type:"list",categories:[],use_bootstrap:!1,use_social_likes:!0,event_id_list:"",category_list:[],limit:0};e.prototype={init:function(){this.build(this,this.element,this.settings),this.readSelectionFromCookies(this,this.element,this.settings),this.filterSelect_Change(this,this.element,this.settings)},build:function(b,c,d){switch(b.encodeFilters(b,c,d),d.view_type){case"feature":a(c).append(b.buildFeature(b,c,d)),a(".lbo-social-likes").socialLikes();break;case"timeline":a(c).append(b.buildTimeLine(b,c,d));break;case"boardwalk":a(c).append(b.buildBoardWalk(b,c,d))}},buildBoardWalk:function(b,c,d){var e="",f=b.getEventsByCategory(b,c,d),g=null;e+='<div class="lbo-board-walk">';for(var h in f)g=b.getCategoryById(b,c,d,h),e+='<div class="lbo-board-walk-item">',e+='<div class="lbo-category-title">'+g.title+"</div>",e+="<ul>",a(f[h]).each(function(a,f){e+=b.viewBoadwalkItem(b,c,d,f)}),e+="</ul>",e+="</div>";return e+="</div>"},buildFeature:function(b,c,d){var e="",f=this.getEventsData(b,c,d);return e+='<ul class="'+b.getWrapperClasses(c,d)+'">',a(f).each(function(a,f){e+=b.viewFeature(b,c,d,f)}),e+="</ul>"},buildTimeLine:function(a,b,c){var d="",e=this.getPerformancesByDateData(a,b,c);d+='<div class="lbo-timeline-wrapper">',d+='<ul class="'+a.getWrapperClasses(b,c)+'">';for(var f in e)d+=a.viewCalendar(a,b,c,e[f]);return d+="</ul></div>"},getWrapperClasses:function(a,b){switch(b.view_type){case"feature":return"lbo-feature-list";case"grid":return"lbo-events-grid cs-style-3 grid";case"timeline":return"lbo-timeline"}},getEventsData:function(a,b,c){var d=[];if(0==c.event_id_list.length)d=lbo_events;else for(var e=c.event_id_list,f=0;f<lbo_events.length-1;f++)e.indexOf(parseInt(lbo_events[f].id))>-1&&d.push(lbo_events[f]);return d},getCategoriesData:function(){return lbo_categories},getVenuesData:function(){return lbo_venues},getPerformancesByDateData:function(b,c,e){var f=b.getEventsData(b,c,e),g=[],h=null,i=null;return a(f).each(function(b,c){a(c.performances).each(function(a,b){h=b.start_date.replace(/-/gi,""),i=h.concat(b.start_time.replace(/:/gi,"")),performance_index=i.concat(b.id),g[h]==d&&(g[h]=[]),b.event=c,g[h][performance_index]=b})}),g},getEventsByCategory:function(b,c,e){var f=[],g=b.getEventsData(b,c,e);return a(g).each(function(b,c){a(c.categories).each(function(a,b){f[b]==d&&(f[b]=[]),f[b].push(c)})}),f},getCategoryById:function(b,c,d,e){var f=null;return a(b.getCategoriesData()).each(function(a,b){b.id==e&&(f=b)}),f},filterSelect_Change:function(b,c,d){var e=a(c).find("select.lbo-filter-category").val(),f=a(c).find("select.lbo-filter-venue").val(),g=[],h=null,i=!1;a(c).find(".lbo-event").each(function(b,c){if(i=!1,g=String(a(c).data("item-categories")).split("==[]=="),h=a(c).data("item-venue"),0!=e)for(var d=0;d<g.length;d++)g[d]==e&&(i=!0);else i=!0;0!=f&&h!=f&&(i=!1),i&&a(c).css("display","block"),i=!1}),b.saveSelectionToCookies(b,c,d)},saveSelectionToCookies:function(b,c){var d=a(c).find("select.lbo-filter-category").val(),e=a(c).find("select.lbo-filter-venue").val();b.setCookie("lbo_category_id",d,7),b.setCookie("lbo_venue_id",e,7)},readSelectionFromCookies:function(b,c){var d=null==b.getCookie("lbo_category_id")?"0":b.getCookie("lbo_category_id"),e=null==b.getCookie("lbo_venue_id")?"0":b.getCookie("lbo_venue_id");a(c).find("select.lbo-filter-category").val(d),a(c).find("select.lbo-filter-venue").val(e)},encodeFilters:function(a,b,c){switch(c.view_type){case"list":return a.encodeFiltersList(a,b,c);case"timeline":return a.encodeFiltersCalendarBar(a,b,c)}},encodeFiltersCalendarBar:function(){},encodeFiltersList:function(b,c,d){var e=a('<select class="lbo-filter-category"></select>').appendTo(c),f=b.getCategoriesData(),g=a('<select class="lbo-filter-venue"></select>').appendTo(c),h=b.getVenuesData();a("<option />",{value:0,text:"All Categories"}).appendTo(e);for(var i=0;i<f.length;i++)a("<option />",{value:f[i].id,text:f[i].title}).appendTo(e);for(a("<option />",{value:0,text:"All Venues"}).appendTo(g),i=0;i<h.length;i++)a("<option />",{value:h[i].id,text:h[i].title}).appendTo(g);e.change(function(){b.filterSelect_Change(b,c,d)}),g.change(function(){b.filterSelect_Change(b,c,d)})},encodeSocialLikes:function(a,b,c,d){var e="";return 1==c.use_social_likes&&(e=a.viewSocialLike(a,b,c,d)),e},viewBoadwalkItem:function(a,b,c,d){return'<li class="lbo-event-'+d.id+'"><a href="'+d.link_view+'"><img src="'+d.image_small+'"/><span>'+d.title+"</span></a></li>"},viewSocialLike:function(a,b,c,d){return'<div class="lbo-social-likes" data-counters="no" data-url="'+d.link+'" data-title="'+d.title+'"><div class="facebook" title="Share link on Facebook">Facebook</div><div class="twitter" title="Share link on Twitter">Twitter</div><div class="plusone" title="Share link on Google+">Google+</div><div class="pinterest" title="Share image on Pinterest" data-media="'+d.image_large+'">Pinterest</div></div>'},viewCalendar:function(a,b,c,d){var e='<div class="lbo-performance-date">',f="",g="";for(var h in d)g=d[h].start_date,book_link=d[h].event.link_base+"/book/selection/"+d[h].id,f+='<div class="lbo-performance-date-item"><a href="'+book_link+'">'+a.formatTime(d[h].start_time)+'</a> <a href="'+d[h].event.link_view+'">'+d[h].event.title+"</a></div>";return e+='<div class="lbo-date-header">'+a.formatDate(a,g)+"</div>",e+='<div class="lbo-perfromance-date-items">'+f+"</div>",e+="</div>"},viewFeature:function(b,c,d,e){var f=1==d.use_bootstrap?"lbo-event-book btn btn-primary":"lbo-event-book",g=b.encodeSocialLikes(b,c,d,e),h="",i=b.viewFeatureDate(b,c,d,e);return a(e.performances).each(function(a,b){h+='<div class="lbo-performance" data-raw="'+b.start_date+" "+b.start_time+'"></div>'}),'<li class="lbo-event lbo-event-'+e.id+'" data-item-categories="'+e.categories.join("==[]==")+'" data-item-venue="'+e.venue_id+'"><figure><div class="crop"><img src="'+e.image_large+'"/></div><figcaption><h3><a href="'+e.link_view+'">'+e.title+"</a></h3>"+i+'<div class="lbo-event-teaser">'+e.teaser+'</div></figcaption><div class="performances">'+h+'</div><div class="lbo-event-footer">'+g+'<a class="btn btn-default lbo-event-performances" href="#">Performances</a><a class="'+f+'" href="'+e.link_book+'">Book Tickets</a></div></figure></li>'},viewGrid:function(a,b){return'<li><figure class="lbo-eb-event"><div class="crop"><img src="'+b.image_large+'"/></div><figcaption><h3>'+b.title+"</h3><span>"+b.teaser+'</span><a href="'+b.link_book+'">Book Tickets</a></figcaption></figure></li>'},viewFeatureDate:function(b,c,d,e){var f=a(e.performances).first(),g=a(e.performances).last(),h=(e.url_base+"/book/selection/",'<strong class="lbo-event-dates">'+b.formatDate(b,f[0].start_date)+" "+b.formatTime(f[0].start_time));return e.performances.length>1&&(h=h+" - "+b.formatDate(b,g[0].start_date)+" "+b.formatTime(g[0].start_time)),h+="</strong>"},formatDate:function(a,b){var c=b.split("-"),d=a.getStringDay(b);return d+" "+c[2]+" "+a.getStringMonth(b)+" "+c[0]},formatTime:function(a){return a.substr(0,a.lastIndexOf(":"))},getStringDay:function(a){var b=new Date(a),c=new Array(7);return c[0]="Sunday",c[1]="Monday",c[2]="Tuesday",c[3]="Wednesday",c[4]="Thursday",c[5]="Friday",c[6]="Saturday",c[b.getDay()]},getStringMonth:function(a){var b=new Date(a),c=new Array;return c[0]="January",c[1]="February",c[2]="March",c[3]="April",c[4]="May",c[5]="June",c[6]="July",c[7]="August",c[8]="September",c[9]="October",c[10]="November",c[11]="December",c[b.getMonth()]},setCookie:function(a,b,d){if(d){var e=new Date;e.setTime(e.getTime()+24*d*60*60*1e3);var f="; expires="+e.toGMTString()}else var f="";c.cookie=a+"="+b+f+"; path=/"},getCookie:function(a){for(var b=a+"=",d=c.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1,f.length);if(0==f.indexOf(b))return f.substring(b.length,f.length)}return null},hasSelectValue:function(b){a(b).find("option").each(function(){})}},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))}),this}}(jQuery,window,document);