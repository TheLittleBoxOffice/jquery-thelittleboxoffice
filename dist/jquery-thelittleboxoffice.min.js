/*! jquery-thelittleboxoffice 2014-11-19 */
!function(a){a.fn.thelittleboxoffice={},a.extend(a.fn.thelittleboxoffice,{default_options:{query:"",template:"default",target:null,theme:"billboard"},build:function(b){b=a.extend(this.default_options,b);var c=a.fn.thelittleboxoffice.query(b.query,!0),d=a.fn.thelittleboxoffice.getThemeFunctionName(b.theme);a(b.target).html(a.fn.thelittleboxoffice[d](c))},listCategories:function(b){a(b.target).html(a.fn.thelittleboxoffice.template({categories:lbo_categories},"misc/category_list"))},getThemeFunctionName:function(a){return"theme"+this.capitaliseFirstLetter(a)+"Encode"},capitaliseFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},dateToInt:function(a){return parseInt(a.replace(/-/gi,"").replace(/:/gi,""))},strToDate:function(a){var b=a.split(" "),c=b[0].split("-"),d=b[1].split(":");return new Date(parseInt(c[0]),parseInt(c[1]),parseInt(c[2]),parseInt(d[0]),parseInt(d[1]),parseInt(d[2]))},getWeekDays:function(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},getMonths:function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}})}(jQuery);var lbo_previous=[];!function(a){a.extend(a.fn.thelittleboxoffice,{query:function(a,b){for(var c=this.cloneDataSet(),d=this.decodeCommands(a),e=0;e<d.length;e++)c=this.processCommand(d[e],c);return b===!0&&this.addToPrevious(c),c},cloneDataSet:function(){output=[];for(var a=0;a<lbo_events.length;a++)output.push(lbo_events[a]);return output},addToPrevious:function(a){for(var b=0;b<a.length;b++)lbo_previous.push(a[b])},hasFilter:function(b){for(var c=!1,d=0;d<b.length;d++)a.inArray(b[d].name,["category_id","event_id"])&&(c=!0);return c},decodeCommands:function(a){var b=[],c=[],d=null,e=null;if(a.length>0){c=a.split(";");for(var f=0;f<c.length;f++)e=c[f].match(/([^A-Z_])/i),null!=e&&(d=e.index,b.push({name:c[f].substring(0,d),operand:c[f].substring(d,d+1),params:c[f].substring(d+1,c[f].length).split(",")}));b.sort(function(a){var b=9999;switch(a.name){case"original":b=0;case"category_id":b=1;break;case"event_id":b=2;break;case"search":b=3;break;case"sort":b=98;break;case"limit":b=99}return b})}return 0==this.hasFilter(b)&&b.push({name:"all",operand:"",params:""}),b},translateFieldName:function(a){switch(a){case"event_id":return"id";default:return a}},processCommand:function(a,b){switch(a.name){case"all":return this.processCommandAll(b);case"original":return this.processCommandOriginal(b);case"category_id":return this.processCommandCategoryId(a.operand,a.params,b);case"event_id":return this.processCommandEventId(a.operand,a.params,b);case"sort":return this.processCommandSort(a.operand,a.params,b);case"limit":return this.processCommandLimit(a.operand,a.params,b)}},processCommandLimit:function(a,b,c){for(var d=parseInt(b.pop()),e=[],f=0;f<c.length;f++)d>f&&e.push(c[f]);return e},processCommandAll:function(a){return a},processCommandEventId:function(a,b,c){this.applyFilter(this.translateFieldName("event_id"),a,this.decodeParams(a,b),c)},processCommandOriginal:function(a){return lbo_previous.length>0?this.applyOriginalFilter(a):a},processCommandCategoryId:function(a,b,c){return this.applyCategoryIdFilter(a,this.decodeParams(a,b),c)},processCommandSort:function(){},applyFilter:function(a,b,c,d){for(var e=!1,f=0;f<d.length;f++){e=!1,d[f]["filter_"+a]=!1;for(var g=0;g<c.length;g++)String(d[f][a])==String(c[g].value)&&(e=!0);e&&(d[f]["filter_"+a]=!0)}},applyCategoryIdFilter:function(a,b,c){for(var d=[],e=!1,f=0;f<c.length;f++)for(var g=0;g<c[f].categories.length;g++){e=!1;for(var h=0;h<b.length;h++)c[f].categories[g]==b[h].value&&(e=!0);e&&d.push(c[f])}return d},applyOriginalFilter:function(a){for(var b=[],c=!1,d=0;d<a.length;d++){c=!1;for(var e=0;e<lbo_previous.length;e++)a[d].id==lbo_previous[e].id&&(c=!0);0==c&&b.push(a[d])}return b},decodeParams:function(a,b){for(var c=[],d=0;d<b.length;d++)c.push({value:b[d].replace(/\"/g,"").replace("!","")});return c},convertDataSetToPerformance:function(a){for(var b=[],c=0;c<a.length;c++)for(var d=0;d<a[c].performances.length;d++){var e={};e.title=a[c].title,e.image_large=a[c].image_large,e.teaser=a[c].teaser,e.start_date=a[c].performances[d].start_date,e.start_time=a[c].performances[d].start_time,e.link_book=a[c].link_book,b.push(e)}return b}})}(jQuery),function(a){a.extend(a.fn.thelittleboxoffice,{template:function(a,b){return this.bakeTemplate(this.getTemplate(b),a)},getTemplate:function(a){return templates["src/templates/"+a+".html"]},bakeTemplate:function(a,b){return a(b)}})}(jQuery),function(a){a.extend(a.fn.thelittleboxoffice,{themeBillboardEncode:function(b){for(var c="",d=0;d<b.length;d++)c+=a.fn.thelittleboxoffice.template(b[d],"billboard/billboard_item");return c},themeBillboardSmallEncode:function(b){for(var c="",d=0;d<b.length;d++)c+=a.fn.thelittleboxoffice.template(b[d],"billboard/billboard_small_item");return c}})}(jQuery),function(a){a.extend(a.fn.thelittleboxoffice,{themeListEncode:function(b){for(var c="",d=0;d<b.length;d++)c+=a.fn.thelittleboxoffice.template(b[d],"list/list_item");return c}})}(jQuery),function(a){a.extend(a.fn.thelittleboxoffice,{month_view_default_options:{query:"test",target:null},monthView:function(b){var c="";b=a.extend(this.month_view_default_options,b),a(b.target).data("month_view_query_string",b.query),c+=a.fn.thelittleboxoffice.template({month_select:a.fn.thelittleboxoffice.monthSelectEncode()},"month_view/month_view_base"),a(b.target).html(c),this.monthViewHookUpEvents(b.target.parent().find("select")),a.fn.thelittleboxoffice.monthView_Change(null,a(b.target))},monthViewHookUpEvents:function(b){a(b).change(this.monthView_Change)},monthView_Change:function(b,c){var d="",e=c,f=a(c).find("select");null!=b&&(e=a(b.currentTarget).parent().parent(),f=a(e).find("select"));for(var g=a.fn.thelittleboxoffice.getMonthViewData(a(e).data("month_view_query_string"),a(f).val().split("_")[1],a(f).val().split("_")[0]),h=0;h<g.length;h++)d+=a.fn.thelittleboxoffice.template(g[h],"month_view/month_view_performance");a(e).find(".lbo-performances").html(d)},monthSelectEncode:function(){return a.fn.thelittleboxoffice.template({active_months:a.fn.thelittleboxoffice.getActiveMonths()},"month_view/month_view_select")}})}(jQuery),function(a){a.extend(a.fn.thelittleboxoffice,{getActiveMonths:function(){for(var b,c,d,e=a.fn.thelittleboxoffice.getMonths(),f=a.fn.thelittleboxoffice.cloneDataSet(),g=[],h=[],i=0;i<f.length;i++)for(var j=0;j<f[i].performances.length;j++)b=f[i].performances[j].start_date.split("-")[1],c=f[i].performances[j].start_date.split("-")[0],d=String(c).concat(String(b)),void 0==g[d]&&(g[d]={month:b,year:c});var k=Object.keys(g).sort();for(i=0;i<k.length;i++)g[k[i]].text_month=e[parseInt(g[k[i]].month)-1],g[k[i]].key=k[i],h.push(g[k[i]]);return h},getMonthViewData:function(b,c,d){var e=a.fn.thelittleboxoffice.convertDataSetToPerformance(a.fn.thelittleboxoffice.query(b,!1));return e=a.fn.thelittleboxoffice.filterByYearAndMonth(e,c,d),e=a.fn.thelittleboxoffice.sortByStartDate(e),e=a.fn.thelittleboxoffice.addFormattedStartDate(e)},filterByYearAndMonth:function(a,b,c){for(var d=[],e=0;e<a.length;e++)parseInt(a[e].start_date.split("-")[1])==parseInt(c)&&parseInt(a[e].start_date.split("-")[0])==parseInt(b)&&d.push(a[e]);return d},addFormattedStartDate:function(b){for(var c=a.fn.thelittleboxoffice.getWeekDays(),d=0;d<b.length;d++){var e=a.fn.thelittleboxoffice.strToDate(b[d].start_date+" "+b[d].start_time),c=a.fn.thelittleboxoffice.getWeekDays();b[d].start_date_day=c[e.getDay()],b[d].start_date_month_day=e.getDate(),b[d].start_date_short=e.getMinutes()+":"+e.getHours()}return b},sortByStartDate:function(b){return b.sort(function(b,c){var d=a.fn.thelittleboxoffice.dateToInt(b.start_date+b.start_time),e=a.fn.thelittleboxoffice.dateToInt(c.start_date+c.start_time);return e>d?-1:d>e?1:0})}})}(jQuery),this.templates=this.templates||{},this.templates["src/templates/billboard/billboard_item.html"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g="function",h=b.helperMissing,i=this.escapeExpression,j='\n	<div class="lbo-billboard-item">\n		<div class="lbo-crop">\n			<img src="'+i((f=null!=(f=b.image_large||(null!=a?a.image_large:a))?f:h,typeof f===g?f.call(a,{name:"image_large",hash:{},data:d}):f))+'" alt="'+i((f=null!=(f=b.title||(null!=a?a.title:a))?f:h,typeof f===g?f.call(a,{name:"title",hash:{},data:d}):f))+'"/>\n		</div>\n		<h1 class="lbo-title">'+i((f=null!=(f=b.title||(null!=a?a.title:a))?f:h,typeof f===g?f.call(a,{name:"title",hash:{},data:d}):f))+'</h1>\n		<p class="lbo-teaser">';return f=null!=(f=b.teaser||(null!=a?a.teaser:a))?f:h,e=typeof f===g?f.call(a,{name:"teaser",hash:{},data:d}):f,null!=e&&(j+=e),j+'</p>\n		<a href="'+i((f=null!=(f=b.link_view||(null!=a?a.link_view:a))?f:h,typeof f===g?f.call(a,{name:"link_view",hash:{},data:d}):f))+'" class="btn btn-primary btn-lg" role="button">Learn more Â»</a>\n	</div>\n'},useData:!0}),this.templates["src/templates/list/list_item.html"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f="function",g=b.helperMissing,h=this.escapeExpression;return'\n	<div class="lbo-list-item">\n		<div class="lbo-crop">\n			<img src="'+h((e=null!=(e=b.image_small||(null!=a?a.image_small:a))?e:g,typeof e===f?e.call(a,{name:"image_small",hash:{},data:d}):e))+'" alt="'+h((e=null!=(e=b.title||(null!=a?a.title:a))?e:g,typeof e===f?e.call(a,{name:"title",hash:{},data:d}):e))+'"/>\n		</div>\n		<a href="'+h((e=null!=(e=b.link_view||(null!=a?a.link_view:a))?e:g,typeof e===f?e.call(a,{name:"link_view",hash:{},data:d}):e))+'" class="lbo-title">'+h((e=null!=(e=b.title||(null!=a?a.title:a))?e:g,typeof e===f?e.call(a,{name:"title",hash:{},data:d}):e))+"</a>\n	</div>\n"},useData:!0}),this.templates["src/templates/misc/category_list.html"]=Handlebars.template({1:function(a){var b=this.lambda,c=this.escapeExpression;return"    <li>"+c(b(null!=a?a.id:a,a))+" &#58; "+c(b(null!=a?a.title:a,a))+"</li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f="<ul>\n";return e=b.each.call(a,null!=a?a.categories:a,{name:"each",hash:{},fn:this.program(1,d),inverse:this.noop,data:d}),null!=e&&(f+=e),f+"</ul>"},useData:!0}),this.templates["src/templates/month_view/month_view_base.html"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g="function",h=b.helperMissing,i='<div class="lbo-month-view">\n	\n	';return f=null!=(f=b.month_select||(null!=a?a.month_select:a))?f:h,e=typeof f===g?f.call(a,{name:"month_select",hash:{},data:d}):f,null!=e&&(i+=e),i+'\n\n	<ul class="lbo-performances">\n		\n	</ul>\n</div>\n'},useData:!0}),this.templates["src/templates/month_view/month_view_performance.html"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f="function",g=b.helperMissing,h=this.escapeExpression;return'<li>	\n	<div class="lbo-image">\n		<img src="'+h((e=null!=(e=b.image_large||(null!=a?a.image_large:a))?e:g,typeof e===f?e.call(a,{name:"image_large",hash:{},data:d}):e))+'" />\n	</div>\n	<span class="lbo-time">\n		<span class="lbo-start-month-day">'+h((e=null!=(e=b.start_date_month_day||(null!=a?a.start_date_month_day:a))?e:g,typeof e===f?e.call(a,{name:"start_date_month_day",hash:{},data:d}):e))+'</span>\n		<span class="lbo-start-day">'+h((e=null!=(e=b.start_date_day||(null!=a?a.start_date_day:a))?e:g,typeof e===f?e.call(a,{name:"start_date_day",hash:{},data:d}):e))+'</span>\n	</span>\n	<div class="lbo-title">\n		<a href="'+h((e=null!=(e=b.link_book||(null!=a?a.link_book:a))?e:g,typeof e===f?e.call(a,{name:"link_book",hash:{},data:d}):e))+'">'+h((e=null!=(e=b.title||(null!=a?a.title:a))?e:g,typeof e===f?e.call(a,{name:"title",hash:{},data:d}):e))+"</a>\n	</div>\n</li>"},useData:!0}),this.templates["src/templates/month_view/month_view_select.html"]=Handlebars.template({1:function(a){var b=this.lambda,c=this.escapeExpression;return'			<option value="'+c(b(null!=a?a.month:a,a))+"_"+c(b(null!=a?a.year:a,a))+'">'+c(b(null!=a?a.text_month:a,a))+" "+c(b(null!=a?a.year:a,a))+"</option>	\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f='	<select class="form-control">\n';return e=b.each.call(a,null!=a?a.active_months:a,{name:"each",hash:{},fn:this.program(1,d),inverse:this.noop,data:d}),null!=e&&(f+=e),f+"	</select>"},useData:!0});